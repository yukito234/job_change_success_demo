(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{366:function(e,t,r){"use strict";var n=r(54),o=r.n(n),l=(r(113),{data:function(){return{userFlag:this.$store.getters["persistedParameter/getIsLoginUser"]}},methods:{signOut:function(){var e=this;this.$store.commit("nameInit"),this.$store.commit("persistedParameter/userIdPersistedInit"),this.$store.dispatch("persistedParameter/changeIsLoginUserAction",!1),this.$store.commit("persistedParameter/changeIsEmpty",!0),o.a.auth().signOut().then((function(){e.$router.go({path:e.$router.currentRoute.path,force:!0}),e.$router.push("/")}))}},computed:{checkUser:function(){return this.userFlag}}}),c=r(36),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-menu",{attrs:{mode:"horizontal",router:!0}},[r("el-menu-item",{attrs:{index:"1",route:{path:"/"}}},[e._v("\n    トップ\n  ")]),e._v(" "),r("el-menu-item",{attrs:{index:"2",route:{path:"/success-graph"}}},[e._v("\n    成功者グラフ\n  ")]),e._v(" "),e.checkUser?r("el-menu-item",{attrs:{index:"3",route:{path:"/member"}}},[e._v("\n    ユーザ一覧\n  ")]):e._e(),e._v(" "),e.checkUser?r("el-menu-item",{attrs:{index:"4",route:{path:"/dashboard"}}},[e._v("\n    ダッシュボード\n  ")]):e._e(),e._v(" "),e.checkUser?e._e():r("el-menu-item",{attrs:{index:"5",route:{path:"/signin-signup"}}},[e._v("\n    ログイン\n  ")]),e._v(" "),e.checkUser?r("el-menu-item",{attrs:{index:"6",route:{path:"/"}},on:{click:e.signOut}},[e._v("\n    ログアウト\n  ")]):e._e()],1)}),[],!1,null,null,null);t.a=component.exports},552:function(e,t,r){"use strict";r.r(t);r(11),r(54);var n=r(113),o=r(366),l=r(367),c=r.n(l),m={middleware:"authenticated",components:{"global-navi":o.a},data:function(){return{show:!1,loading:!0,mainProps:{width:30,block:!1},fieldsOfCommentData:[{key:"content",label:""}],tableData3:[],fieldsOfLikeArticle:[{key:"titleLink",label:"記事タイトル"},{key:"detailButton",label:"詳細"}],userInfo:"",userComment:"",replyContent:"",allLikeArticlesData:[]}},methods:{getMarginLeft:function(e){return 30*Number(e.nestCount)+"px"},setCommentData:function(element){this.$store.commit("persistedParameter/commentDataSet",element)},registerComment:function(){var e=this;this.show=!0,n.a.collection("user_comment").add({user_id_from:this.$store.state.persistedParameter.userIdPersisted,user_id_to:this.userInfo.user_id,comment:this.userComment,createdAt:new Date}).then((function(){alert("コメントの登録完了"),e.show=!1,e.$store.dispatch("persistedParameter/allCommentDataInitAction"),e.$router.go({path:e.$router.currentRoute.path,force:!0})})).catch((function(e){alert(e.message)}))}},created:function(){var e=this;this.$store.dispatch("persistedParameter/allCommentDataInitAction"),n.a.collection("like_articles").get().then((function(t){t.forEach((function(t){var data=c.a.cloneDeep(t.data());data.user_name===e.$store.getters["persistedParameter/getUserData"].user_name&&e.allLikeArticlesData.push(data)}))})).catch((function(e){alert(e.message)}))},mounted:function(){var e=this;this.userInfo=c.a.cloneDeep(this.$store.getters["persistedParameter/getUserData"]);var t=[];n.a.collection("user_comment").get().then((function(r){r.forEach((function(r){c.a.cloneDeep(r.data());var n=c.a.cloneDeep(r.data());n.commentId=r.id,n.isAddition=!1,n.nestCount=null,n.nestArray=[],n.numberForNestArray=0;for(var i=0;i<e.$store.getters["persistedParameter/getAllProfilePersisted"].length;i++)e.$store.getters["persistedParameter/getAllProfilePersisted"][i].user_id===n.user_id_from&&(n.nick_name_from=e.$store.getters["persistedParameter/getAllProfilePersisted"][i].nick_name,n.image_url=e.$store.getters["persistedParameter/getAllProfilePersisted"][i].image_url);t.push(n)})),console.log("DBから取得した全コメント:"),console.log("dataStockArray_2:"),console.log(t);for(var i=0;i<t.length;i++)t[i].createdAt&&(t[i].createdAt=t[i].createdAt.toDate());for(var n=[],o=0;o<t.length;o++)if(void 0===t[o].reply_comment_id&&e.userInfo.user_id===t[o].user_id_to){t[o].isAddition=!0,t[o].nestCount=0;var l=c.a.cloneDeep(t[o]);n.push(l)}n.sort((function(a,b){return a.createdAt-b.createdAt})),console.log("プロフィールユーザ向けの初回コメント（時系列順）:"),console.log("targetDataArray_2:"),console.log(n);for(var m=[],d=0;d<n.length;d++){m.push(n[d]);for(var _=0;_<t.length;_++)if(t[_].reply_comment_id===n[d].commentId){if(!t[_].isAddition){t[_].isAddition=!0,t[_].nestCount=1;var f=c.a.cloneDeep(t[_]);n[d].nestArray.push(f),m.push(f)}for(var h=0;h<t.length;h++)if(t[h].reply_comment_id===t[_].commentId){if(!t[h].isAddition){t[h].isAddition=!0,t[h].nestCount=2;var v=c.a.cloneDeep(t[h]);n[d].nestArray.push(v),m.push(v)}for(var A=0;A<t.length;A++)if(t[A].reply_comment_id===t[h].commentId&&!t[A].isAddition){t[A].isAddition=!0,t[A].nestCount=3;var k=c.a.cloneDeep(t[A]);n[d].nestArray.push(k),m.push(k)}}}}console.log("プロフィールユーザ向けの初回コメントと返信コメント:"),console.log("targetDataArray_2:"),console.log(n),console.log("displayArray_2:"),console.log(m);for(var y=0;y<m.length;y++){var D=String(Number(m[y].createdAt.getMonth())+1),P=m[y].createdAt.getFullYear()+"年"+D+"月"+m[y].createdAt.getDate()+"日"+m[y].createdAt.getHours()+"時"+m[y].createdAt.getMinutes()+"分";m[y].createdAt=P}for(var C=0;C<m.length;C++)m[C].replyButtonFlag=!1;if(e.$store.getters["persistedParameter/getUserIdPersisted"]===e.userInfo.user_id)for(var w=0;w<m.length;w++)0===m[w].nestCount&&0===m[w+1].nestCount&&(m[w].replyButtonFlag=!0),2===m[w].nestCount&&0===m[w+1].nestCount&&(m[w].replyButtonFlag=!0);else for(var $=0;$<m.length;$++)1===m[$].nestCount&&m[$].user_id_to===e.userInfo.user_id&&0===m[$+1].nestCount&&(m[$].replyButtonFlag=!0);console.log("displayArray_2 after replyButton addition:"),console.log(m);for(var j=0;j<m.length;j++)e.tableData3.push(m[j]);e.loading=!1})).catch((function(e){alert(e.message)}))}},d=r(36),component=Object(d.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("global-navi"),e._v(" "),r("b-spinner",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{small:""}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}]},[r("h2",[e._v(e._s(e.$store.getters["persistedParameter/getUserData"].nick_name)+"さんのプロフィール")]),e._v(" "),r("b-card",{staticStyle:{"max-width":"540px"},attrs:{"no-body":""}},[r("b-row",[r("b-col",{attrs:{md:"6"}},[r("b-img",{attrs:{src:e.$store.getters["persistedParameter/getUserData"].image_url,alt:""}})],1),e._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-card-body",{attrs:{title:e.$store.getters["persistedParameter/getUserData"].nick_name}},[r("b-card-text",[e._v("\n                "+e._s(e.$store.getters["persistedParameter/getUserData"].self_introduction)+"\n                abcdedffgadfasdfeilsdjfksjfoeilsdfjksjdfif\n                asdfalsfjieasjdlfjalskjdflsjdlfaskdjflsajdlfa\n                asjdfjlasdjflasjdflkjasdlfkjlasdjflasdjflajsdf\n              ")])],1)],1)],1)],1),e._v(" "),r("h2",[e._v("お気に入り記事")]),e._v(" "),r("b-table",{attrs:{items:e.allLikeArticlesData,fields:e.fieldsOfLikeArticle,responsive:"sm"},scopedSlots:e._u([{key:"cell(titleLink)",fn:function(data){return[r("a",{attrs:{href:data.item.url}},[e._v(e._s(data.item.title))])]}},{key:"cell(detailButton)",fn:function(t){return[r("b-button",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:t.toggleDetails}},[e._v("\n            \n              "+e._s(t.detailsShowing?"閉じる":"詳細")+"\n            ")])]}},{key:"row-details",fn:function(t){return[r("b-card",[r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[r("b",[e._v("おすすめする人:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.recommendation))])],1),e._v(" "),r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[r("b",[e._v("コメント:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.free_text_area))])],1)],1)]}}])}),e._v(" "),r("h2",[e._v("コメントを残す")]),e._v(" "),r("b-overlay",{attrs:{show:e.show,rounded:"sm"}},[r("b-card",{attrs:{"bg-variant":"light"}},[r("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"3","max-rows":"6"},model:{value:e.userComment,callback:function(t){e.userComment=t},expression:"userComment"}}),e._v(" "),r("b-button",{on:{click:e.registerComment}},[e._v("コメントを送信する")])],1)],1),e._v(" "),r("h2",[e._v("コメント一覧")]),e._v(" "),r("b-table",{attrs:{items:e.tableData3,fields:e.fieldsOfCommentData,responsive:"sm"},scopedSlots:e._u([{key:"cell(content)",fn:function(data){return[r("div",{style:{marginLeft:e.getMarginLeft(data.item)}},[r("b-img",e._b({attrs:{src:data.item.image_url}},"b-img",e.mainProps,!1)),e._v(" "),r("span",[e._v(e._s(data.item.nick_name_from))]),e._v(" "),r("p",[e._v(e._s(data.item.comment))]),e._v(" "),r("span",[e._v(e._s(data.item.createdAt))]),e._v(" "),data.item.replyButtonFlag?r("router-link",{attrs:{to:{path:"/reply"}},nativeOn:{click:function(t){return e.setCommentData(data.item)}}},[e._v("返信する")]):e._e(),e._v(" "),r("p",[e._v("commentId:  "+e._s(data.item.commentId))]),e._v(" "),r("p",[e._v("reply_comment_id:  "+e._s(data.item.reply_comment_id))])],1)]}}])})],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);