(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{501:function(e,t,o){var content=o(651);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(75).default)("084e7d43",content,!0,{sourceMap:!1})},502:function(e,t,o){var content=o(653);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(75).default)("3ec4bd80",content,!0,{sourceMap:!1})},503:function(e,t,o){var content=o(655);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(75).default)("7461aebc",content,!0,{sourceMap:!1})},650:function(e,t,o){"use strict";var n=o(501);o.n(n).a},651:function(e,t,o){(t=o(74)(!1)).push([e.i,".profileimage[data-v-c271ab0e]{width:250px}",""]),e.exports=t},652:function(e,t,o){"use strict";var n=o(502);o.n(n).a},653:function(e,t,o){(t=o(74)(!1)).push([e.i,".h2title[data-v-74a13d80]{display:inline-block}",""]),e.exports=t},654:function(e,t,o){"use strict";var n=o(503);o.n(n).a},655:function(e,t,o){(t=o(74)(!1)).push([e.i,".submit-button[data-v-0600e1f6]{display:block;margin-left:auto}",""]),e.exports=t},679:function(e,t,o){"use strict";o.r(t);o(76);var n=o(19),l=(o(32),o(23),o(47)),r=o.n(l),c={computed:{getProfile:function(){return this.$store.getters["sessionStorageParameter/getClickedProfileData"]}}},m=(o(650),o(46)),d=Object(m.a)(c,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h2",[e._v(e._s(e.getProfile.nick_name)+"さんのプロフィール")]),e._v(" "),o("b-card",{staticStyle:{"max-width":"540px"},attrs:{"no-body":""}},[o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-img",{staticClass:"profileimage",attrs:{src:e.getProfile.image_url,alt:""}})],1),e._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-card-body",{attrs:{title:e.getProfile.nick_name}},[o("b-card-text",[e._v("\n                "+e._s(e.getProfile.self_introduction)+"\n                \n              ")])],1)],1)],1)],1)],1)}),[],!1,null,"c271ab0e",null).exports,f=o(82),h=o(0),_={components:{BIcon:f.a,BIconX:h.ik,BIconQuestionCircle:h.fi,BIconChevronDown:h.dd},data:function(){return{likeArticles:[],fieldsOfLikeArticle:[{key:"titleLink",label:"記事タイトル"},{key:"detailButton",label:"コメント"}]}},created:function(){this.getLikeArticles()},computed:{getIsTableDisplay:function(){return this.likeArticles.length>=1}},methods:{getLikeArticles:function(){this.likeArticles.splice(-this.likeArticles.length);for(var e=r()(this.$store.getters.getAllLikeArticles),t=this.$store.getters["sessionStorageParameter/getClickedProfileData"],i=0;i<e.length;i++)void 0!==e[i].user_id&&e[i].user_id===t.user_id&&this.likeArticles.push(e[i]);return console.log("this.likeArticles"),console.log(this.likeArticles),this.likeArticles}}},v=(o(652),Object(m.a)(_,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",[o("h2",{staticClass:"h2title"},[e._v("お気に入り記事")]),e._v(" "),o("b-icon",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-like-article-title",modifiers:{"modal-like-article-title":!0}}],attrs:{icon:"question-circle"}}),e._v(" "),o("b-modal",{attrs:{id:"modal-like-article-title","ok-only":""}},[o("p",{staticClass:"my-4"},[e._v("\n          こちらの会員さんのお気に入りの記事をチェックできます。\n          "),o("br"),e._v("お気に入り記事はダッシュボードで登録できますよ！\n        ")])])],1),e._v(" "),e.getIsTableDisplay?o("b-table",{attrs:{items:e.likeArticles,fields:e.fieldsOfLikeArticle,responsive:"sm"},scopedSlots:e._u([{key:"cell(titleLink)",fn:function(data){return[o("a",{attrs:{href:data.item.url}},[e._v(e._s(data.item.title))])]}},{key:"cell(detailButton)",fn:function(t){return[o("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"primary"},on:{click:t.toggleDetails}},[e._v("\n            \n              "+e._s(t.detailsShowing?"閉じる":"開く")),o("b-icon",{attrs:{icon:"chevron-down"}})],1)]}},{key:"row-details",fn:function(t){return[o("b-card",[o("b-row",{staticClass:"mb-2"},[o("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[o("b",[e._v("おすすめする人:")])]),e._v(" "),o("b-col",[e._v(e._s(t.item.recommendation))])],1),e._v(" "),o("b-row",{staticClass:"mb-2"},[o("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[o("b",[e._v("コメント:")])]),e._v(" "),o("b-col",[e._v(e._s(t.item.free_text_area))])],1)],1)]}}],null,!1,3791252748)}):e._e()],1)}),[],!1,null,"74a13d80",null).exports),C=o(496),k=o.n(C),A={data:function(){return{userComment:""}},computed:{getIsProfileRegistration:function(){return this.$store.getters["sessionStorageParameter/getLoginUserData"].is_profile_registration}},methods:{registerComment:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("this.userComment in registerComment"),console.log(e.userComment),""!==e.userComment){t.next=5;break}return alert("コメントを入力してください！"),t.abrupt("return");case 5:return t.next=7,e.$store.dispatch("registerCommentAction",k()(e.userComment));case 7:return t.next=9,e.$store.dispatch("commentsGetAction");case 9:e.$emit("commentRegisteredNotice"),e.userComment="";case 11:case"end":return t.stop()}}),t)})))()}}},y=(o(654),Object(m.a)(A,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h2",[e._v("コメントを残す")]),e._v(" "),e.getIsProfileRegistration?o("b-card",{attrs:{"bg-variant":"light"}},[o("b-form-textarea",{attrs:{id:"textarea",placeholder:"コメントを入力してください！",rows:"3","max-rows":"6"},model:{value:e.userComment,callback:function(t){e.userComment="string"==typeof t?t.trim():t},expression:"userComment"}}),e._v(" "),o("div",[o("b-button",{staticClass:"submit-button",attrs:{variant:"primary"},on:{click:e.registerComment}},[e._v("コメントを送信")])],1)],1):o("b-card",{attrs:{"bg-variant":"light"}},[o("p",[e._v("コメントを残すには、ダッシュボードページでプロフィール登録をしてください！")]),e._v(" "),o("b-form-textarea",{attrs:{id:"textarea",placeholder:"コメントを入力できません。",rows:"3","max-rows":"6",disabled:"disabled"},model:{value:e.userComment,callback:function(t){e.userComment="string"==typeof t?t.trim():t},expression:"userComment"}}),e._v(" "),o("div",[o("b-button",{staticClass:"submit-button",attrs:{disabled:!e.getIsProfileRegistration},on:{click:e.registerComment}},[e._v("コメントを送信できません")])],1)],1)],1)}),[],!1,null,"0600e1f6",null).exports),x=(o(21),{props:["isCallGetComments"],data:function(){return{commentsForTable:[],fieldsOfCommentData:[{key:"content",label:""}],mainProps:{width:30,block:!1}}},created:function(){this.getComments()},watch:{isCallGetComments:function(){console.log("enter isCallGetComments"),this.isCallGetComments&&(console.log("this.isCallGetComments"),console.log(this.isCallGetComments),this.getComments())}},computed:{getIsCommentMessage:function(){return!(this.commentsForTable.length>=1)}},methods:{getComments:function(){console.log("enter getComments");var e=r()(this.$store.getters.getAllComments),t=[],o=[],n=this.$store.getters.getAllProfiles,l=this.$store.getters["sessionStorageParameter/getClickedProfileData"],c=this.$store.getters["sessionStorageParameter/getLoginUserData"];console.log("allProfiles"),console.log(n),console.log("profileDataOfThisPage"),console.log(l),console.log("loginUserData"),console.log(c);for(var i=0;i<e.length;i++)void 0===e[i].reply_comment_id&&l.user_id===e[i].user_id_to&&(e[i].isAddition=!0,e[i].nestCount=0,t.push(e[i]));console.log("firstCommentsOfThisPage"),console.log(t),t.sort((function(a,b){return a.createdAt-b.createdAt}));var m=r()(t),d=[],f=r()(e);console.log("************************************************"),console.log("firstCommentsOfThisPage2"),console.log(m),console.log("allComments2"),console.log(f),console.log("************************************************");for(var h=0;h<t.length;h++){o.push(t[h]);for(var _=0;_<e.length;_++)if(e[_].reply_comment_id===t[h].commentId){if(!e[_].isAddition){e[_].isAddition=!0,e[_].nestCount=1;var v=r()(e[_]);o.push(v)}for(var C=0;C<e.length;C++)if(e[C].reply_comment_id===e[_].commentId){if(!e[C].isAddition){e[C].isAddition=!0,e[C].nestCount=2;var k=r()(e[C]);o.push(k)}for(var A=0;A<e.length;A++)if(e[A].reply_comment_id===e[C].commentId&&!e[A].isAddition){e[A].isAddition=!0,e[A].nestCount=3;var y=r()(e[A]);o.push(y)}}}}console.log("commentsOfThisPage"),console.log(o),console.log("--------------------------------------------------------");for(var x=0;x<o.length;x++)console.log("commentsOfThisPage[".concat(x,"]")),console.log(o[x]);console.log("--------------------------------------------------------"),console.log("commentsOfThisPage2 before");for(var P=0;P<d.length;P++)console.log("commentsOfThisPage2[".concat(P,"]")),console.log(d[P]);for(var I=0;I<m.length;I++){d.push(m[I]),console.log("after pushed to commentsOfThisPage2 in head");for(var w=0;w<d.length;w++)console.log("commentsOfThisPage2[".concat(w,"]")),console.log(d[w]);O(I,1)}function O(e,t){if(console.log("enter getNestCommet"),1!==t){for(var o=0;o<f.length;o++)if(f[o].reply_comment_id===f[e].commentId){if(console.log("nest=".concat(t).concat(t).concat(t).concat(t).concat(t).concat(t).concat(t).concat(t).concat(t).concat(t)),console.log("allComments2[i].reply_comment_id"),console.log(f[o].reply_comment_id),T(o,t),t+1===4)break;O(o,t+1)}}else for(var n=0;n<f.length;n++)f[n].reply_comment_id===m[e].commentId&&(console.log("nest=111111111111111111111111111111111111111111111111111111111111"),console.log("allComments2[".concat(n,"]")),console.log(f[n].comment),T(n,t),O(n,t+1))}function T(e,t){if(console.log("seeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeet"),console.log("currentNestCount=".concat(t)),console.log("allComments2[".concat(e,"]=")),console.log(f[e].comment),!f[e].isAddition){f[e].isAddition=!0,f[e].nestCount=t;var element=r()(f[e]);d.push(element)}}console.log("last--------------------------------------------------------");for(var D=0;D<d.length;D++)console.log("commentsOfThisPage2[".concat(D,"]")),console.log(d[D]);console.log("--------------------------------------------------------");for(var G=0;G<o.length;G++){var F=String(Number(o[G].createdAt.getMonth())+1),$=o[G].createdAt.getFullYear()+"年"+F+"月"+o[G].createdAt.getDate()+"日"+o[G].createdAt.getHours()+"時"+o[G].createdAt.getMinutes()+"分";o[G].createdAt=$}for(var L=0;L<o.length;L++)o[L].replyButtonFlag=!1;if(c.uid===l.user_id)for(var B=0;B<o.length;B++)o[B].user_id_from!==c.uid?(0===o[B].nestCount&&B===o.length-1?o[B].replyButtonFlag=!0:0===o[B].nestCount&&0===o[B+1].nestCount&&(o[B].replyButtonFlag=!0),2===o[B].nestCount&&B===o.length-1?o[B].replyButtonFlag=!0:2===o[B].nestCount&&0===o[B+1].nestCount&&(o[B].replyButtonFlag=!0)):console.log("以下のコメントは、このプロフィールページの作成者のものです");else for(var S=0;S<o.length;S++)1===o[S].nestCount&&o[S].user_id_to===c.uid&&S===o.length-1?o[S].replyButtonFlag=!0:1===o[S].nestCount&&o.user_id_to===c.uid&&0===o[S+1].nestCount&&(o[S].replyButtonFlag=!0);this.commentsForTable.splice(-this.commentsForTable.length);for(var M=0;M<o.length;M++)this.commentsForTable.push(o[M]);console.log("this.commentsForTable"),console.log(this.commentsForTable)},getMarginLeft:function(e){return 30*Number(e.nestCount)+"px"},setCommentData:function(element){console.log("element:"),console.log(element),this.$store.commit("sessionStorageParameter/commentDataSet",element)}}}),P={middleware:"authenticated",components:{profile:d,"like-articles":v,"do-comment":y,"comment-list":Object(m.a)(x,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h2",[e._v("コメント一覧")]),e._v(" "),e.getIsCommentMessage?e._e():o("b-table",{attrs:{items:e.commentsForTable,fields:e.fieldsOfCommentData,responsive:"sm"},scopedSlots:e._u([{key:"cell(content)",fn:function(data){return[o("div",{style:{marginLeft:e.getMarginLeft(data.item)}},[o("b-img",e._b({attrs:{src:data.item.image_url}},"b-img",e.mainProps,!1)),e._v(" "),o("span",[e._v(e._s(data.item.nick_name_from))]),e._v(" "),o("p",[e._v(e._s(data.item.comment))]),e._v(" "),o("span",[e._v(e._s(data.item.createdAt))]),e._v(" "),data.item.replyButtonFlag?o("nuxt-link",{attrs:{to:{path:"/reply"}},nativeOn:{click:function(t){return e.setCommentData(data.item)}}},[e._v("返信する")]):e._e(),e._v(" "),o("p",[e._v("commentId:  "+e._s(data.item.commentId))]),e._v(" "),o("p",[e._v("reply_comment_id:  "+e._s(data.item.reply_comment_id))])],1)]}}],null,!1,324430049)}),e._v(" "),e.getIsCommentMessage?o("p",[e._v("まだコメントのやり取りはありません。")]):e._e()],1)}),[],!1,null,null,null).exports},data:function(){return{isCallGetComments:!1,show:!1,loading:!0,mainProps:{width:30,block:!1},fieldsOfCommentData:[{key:"content",label:""}],tableData3:[],userInfo:"",userComment:"",replyContent:"",allLikeArticlesData:[],likeArticles:[],commentsForTable:[]}},fetch:function(e){var t=e.store;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.getters.getIsAllLikeArticles){e.next=4;break}return e.next=3,t.dispatch("likeArticlesGetAction");case 3:t.dispatch("changeIsAllLikeArticlesAction",!0);case 4:if(t.getters.getIsAllComments){e.next=9;break}return console.log("enter !store.getters['getIsAllComments']"),e.next=8,t.dispatch("commentsGetAction");case 8:t.dispatch("changeIsAllCommentsAction",!0);case 9:case"end":return e.stop()}}),e)})))()},created:function(){},computed:{obtainIsCallGetComments:function(){return console.log("enter obtainIsCallGetComments"),this.isCallGetComments}},methods:{changeIsCallGetComments:function(){console.log("enter changeIsCallGetComments"),this.isCallGetComments=!0,console.log("this.isCallGetComments"),console.log(this.isCallGetComments)}}},I=Object(m.a)(P,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",[t("profile"),this._v(" "),t("like-articles"),this._v(" "),t("do-comment",{on:{commentRegisteredNotice:this.changeIsCallGetComments}}),this._v(" "),t("comment-list",{attrs:{"is-call-get-comments":this.obtainIsCallGetComments}})],1)])}),[],!1,null,null,null);t.default=I.exports}}]);